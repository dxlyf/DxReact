<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è‹±è¯­å•è¯éŸ³æ ‡ç”Ÿæˆå™¨</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 10px;
            font-size: 2.5em;
        }

        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
        }

        .input-section {
            margin-bottom: 30px;
        }

        .input-wrapper {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .input-wrapper input {
            width: 100%;
        }

        #wordInput {
            flex: 1;
            padding: 15px 20px;
            font-size: 1.2em;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            outline: none;
            transition: border-color 0.3s;
        }

        #wordInput:focus {
            border-color: #667eea;
        }

        .btn {
            padding: 15px 30px;
            font-size: 1.1em;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }

        .result-section {
            display: none;
        }

        .result-section.show {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .phonetic-card {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            border-left: 5px solid;
        }

        .phonetic-card.british {
            border-left-color: #e74c3c;
        }

        .phonetic-card.american {
            border-left-color: #3498db;
        }

        .phonetic-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .flag {
            font-size: 1.5em;
        }

        .phonetic-title {
            font-size: 1.2em;
            font-weight: bold;
            color: #333;
        }

        .phonetic-content {
            font-size: 2em;
            color: #2c3e50;
            font-family: 'Times New Roman', serif;
            letter-spacing: 1px;
        }

        .syllable-section {
            margin-top: 30px;
            padding: 20px;
            background: #fff3cd;
            border-radius: 10px;
            border: 1px solid #ffeaa7;
        }

        .syllable-title {
            font-weight: bold;
            color: #856404;
            margin-bottom: 10px;
        }

        .syllable-content {
            color: #856404;
            font-size: 1.1em;
            line-height: 1.8;
        }

        .rules-section {
            margin-top: 30px;
            padding: 20px;
            background: #d1ecf1;
            border-radius: 10px;
            border: 1px solid #bee5eb;
        }

        .rules-title {
            font-weight: bold;
            color: #0c5460;
            margin-bottom: 10px;
        }

        .rules-content {
            color: #0c5460;
            font-size: 0.95em;
            line-height: 1.8;
        }

        .example-words {
            margin-top: 20px;
        }

        .example-title {
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }

        .example-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .example-item {
            padding: 8px 15px;
            background: #e9ecef;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9em;
        }

        .example-item:hover {
            background: #667eea;
            color: white;
        }

        .error-message {
            color: #e74c3c;
            text-align: center;
            padding: 20px;
            display: none;
        }

        .error-message.show {
            display: block;
        }

        .legend {
            margin-top: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .legend-title {
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
        }

        .legend-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.9em;
        }

        .legend-symbol {
            font-family: 'Times New Roman', serif;
            font-size: 1.2em;
            color: #667eea;
            min-width: 30px;
        }

        .stress-mark {
            color: #e74c3c;
            font-weight: bold;
        }

        .secondary-stress {
            color: #f39c12;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¯ è‹±è¯­å•è¯éŸ³æ ‡ç”Ÿæˆå™¨</h1>
        <p class="subtitle">åŸºäºè‹±è¯­å‘éŸ³è§„åˆ™è‡ªåŠ¨ç”Ÿæˆè‹±å¼ & ç¾å¼éŸ³æ ‡</p>

        <div class="input-section">
            <div class="input-wrapper">
                <input type="text" id="wordInput" placeholder="è¾“å…¥è‹±è¯­å•è¯ (å¦‚: pronunciation)" maxlength="50" autocomplete="off">
            </div>
        </div>

        <div class="error-message" id="errorMessage"></div>

        <div class="result-section" id="resultSection">
            <div class="phonetic-card british">
                <div class="phonetic-header">
                    <span class="flag">ğŸ‡¬ğŸ‡§</span>
                    <span class="phonetic-title">è‹±å¼éŸ³æ ‡ (RP)</span>
                </div>
                <div class="phonetic-content" id="britishPhonetic"></div>
            </div>

            <div class="phonetic-card american">
                <div class="phonetic-header">
                    <span class="flag">ğŸ‡ºğŸ‡¸</span>
                    <span class="phonetic-title">ç¾å¼éŸ³æ ‡ (GA)</span>
                </div>
                <div class="phonetic-content" id="americanPhonetic"></div>
            </div>

            <div class="syllable-section">
                <div class="syllable-title">ğŸ“Š éŸ³èŠ‚åˆ’åˆ†</div>
                <div class="syllable-content" id="syllableInfo"></div>
            </div>

            <div class="rules-section">
                <div class="rules-title">ğŸ“ åº”ç”¨çš„å‘éŸ³è§„åˆ™</div>
                <div class="rules-content" id="rulesInfo"></div>
            </div>
        </div>

        <div class="example-words">
            <div class="example-title">ğŸ’¡ ç‚¹å‡»å°è¯•ä»¥ä¸‹ç¤ºä¾‹å•è¯ï¼š</div>
            <div class="example-list">
                <span class="example-item" onclick="setWord('pronunciation')">pronunciation</span>
                <span class="example-item" onclick="setWord('beautiful')">beautiful</span>
                <span class="example-item" onclick="setWord('schedule')">schedule</span>
                <span class="example-item" onclick="setWord('tomato')">tomato</span>
                <span class="example-item" onclick="setWord('advertisement')">advertisement</span>
                <span class="example-item" onclick="setWord('laboratory')">laboratory</span>
                <span class="example-item" onclick="setWord('vitamin')">vitamin</span>
                <span class="example-item" onclick="setWord('leisure')">leisure</span>
                <span class="example-item" onclick="setWord('either')">either</span>
                <span class="example-item" onclick="setWord('neither')">neither</span>
                <span class="example-item" onclick="setWord('privacy')">privacy</span>
                <span class="example-item" onclick="setWord('progress')">progress</span>
            </div>
        </div>

        <div class="legend">
            <div class="legend-title">ğŸ“š éŸ³æ ‡ç¬¦å·è¯´æ˜</div>
            <div class="legend-grid">
                <div class="legend-item"><span class="legend-symbol">Ëˆ</span> ä¸»é‡éŸ³</div>
                <div class="legend-item"><span class="legend-symbol">ËŒ</span> æ¬¡é‡éŸ³</div>
                <div class="legend-item"><span class="legend-symbol">iË</span> é•¿éŸ³ ee</div>
                <div class="legend-item"><span class="legend-symbol">Éª</span> çŸ­éŸ³ i</div>
                <div class="legend-item"><span class="legend-symbol">eÉª</span> åŒå…ƒéŸ³ ay</div>
                <div class="legend-item"><span class="legend-symbol">aÉª</span> åŒå…ƒéŸ³ eye</div>
                <div class="legend-item"><span class="legend-symbol">É™ÊŠ</span> è‹±å¼ oh</div>
                <div class="legend-item"><span class="legend-symbol">oÊŠ</span> ç¾å¼ oh</div>
                <div class="legend-item"><span class="legend-symbol">É‘Ë</span> è‹±å¼ ah</div>
                <div class="legend-item"><span class="legend-symbol">Ã¦</span> çŸ­éŸ³ a</div>
                <div class="legend-item"><span class="legend-symbol">Êƒ</span> sh éŸ³</div>
                <div class="legend-item"><span class="legend-symbol">Î¸</span> th æ¸…éŸ³</div>
                <div class="legend-item"><span class="legend-symbol">Ã°</span> th æµŠéŸ³</div>
                <div class="legend-item"><span class="legend-symbol">Å‹</span> ng éŸ³</div>
                <div class="legend-item"><span class="legend-symbol">Ê’</span> zh éŸ³</div>
                <div class="legend-item"><span class="legend-symbol">tÊƒ</span> ch éŸ³</div>
                <div class="legend-item"><span class="legend-symbol">dÊ’</span> j éŸ³</div>
                <div class="legend-item"><span class="legend-symbol">r</span> å·èˆŒéŸ³</div>
            </div>
        </div>
    </div>

    <script>
        // è‹±è¯­éŸ³æ ‡è§„åˆ™å¼•æ“ - å®Œå…¨åŸºäºè§„åˆ™è®¡ç®—ï¼Œä¸ä½¿ç”¨å•è¯æ˜ å°„
        
        // éŸ³æ ‡ç¬¦å·å®šä¹‰
        const PHONETIC = {
            // è‹±å¼éŸ³æ ‡
            BR: {
                vowels: {
                    'iË': 'iË', 'Éª': 'Éª', 'e': 'e', 'Ã¦': 'Ã¦',
                    'É‘Ë': 'É‘Ë', 'É’': 'É’', 'É”Ë': 'É”Ë', 'ÊŠ': 'ÊŠ',
                    'uË': 'uË', 'ÊŒ': 'ÊŒ', 'ÉœË': 'ÉœË', 'É™': 'É™',
                    'eÉª': 'eÉª', 'aÉª': 'aÉª', 'É”Éª': 'É”Éª',
                    'aÊŠ': 'aÊŠ', 'É™ÊŠ': 'É™ÊŠ', 'ÉªÉ™': 'ÉªÉ™',
                    'eÉ™': 'eÉ™', 'ÊŠÉ™': 'ÊŠÉ™'
                },
                consonants: {
                    'p': 'p', 'b': 'b', 't': 't', 'd': 'd',
                    'k': 'k', 'g': 'g', 'f': 'f', 'v': 'v',
                    'Î¸': 'Î¸', 'Ã°': 'Ã°', 's': 's', 'z': 'z',
                    'Êƒ': 'Êƒ', 'Ê’': 'Ê’', 'tÊƒ': 'tÊƒ', 'dÊ’': 'dÊ’',
                    'm': 'm', 'n': 'n', 'Å‹': 'Å‹', 'h': 'h',
                    'l': 'l', 'r': 'r', 'w': 'w', 'j': 'j'
                }
            },
            // ç¾å¼éŸ³æ ‡
            AM: {
                vowels: {
                    'iË': 'i', 'Éª': 'Éª', 'e': 'É›', 'Ã¦': 'Ã¦',
                    'É‘Ë': 'É‘', 'É’': 'É‘', 'É”Ë': 'É”', 'ÊŠ': 'ÊŠ',
                    'uË': 'u', 'ÊŒ': 'ÊŒ', 'ÉœË': 'É', 'É™': 'É™',
                    'eÉª': 'e', 'aÉª': 'aÉª', 'É”Éª': 'É”Éª',
                    'aÊŠ': 'aÊŠ', 'É™ÊŠ': 'o', 'ÉªÉ™': 'Éªr',
                    'eÉ™': 'É›r', 'ÊŠÉ™': 'ÊŠr'
                },
                consonants: {
                    'p': 'p', 'b': 'b', 't': 't', 'd': 'd',
                    'k': 'k', 'g': 'g', 'f': 'f', 'v': 'v',
                    'Î¸': 'Î¸', 'Ã°': 'Ã°', 's': 's', 'z': 'z',
                    'Êƒ': 'Êƒ', 'Ê’': 'Ê’', 'tÊƒ': 'tÊƒ', 'dÊ’': 'dÊ’',
                    'm': 'm', 'n': 'n', 'Å‹': 'Å‹', 'h': 'h',
                    'l': 'l', 'r': 'É¹', 'w': 'w', 'j': 'j'
                }
            }
        };

        // å‘éŸ³è§„åˆ™å®šä¹‰ - æŒ‰ä¼˜å…ˆçº§æ’åº
        const PRONUNCIATION_RULES = [
            // ===== ç‰¹æ®Šå­—æ¯ç»„åˆ (æœ€é•¿åŒ¹é…ä¼˜å…ˆ) =====
            // th ç»„åˆ
            { pattern: /^th(?=e[rmn]|is|at|e[ys]|o[us]|r[ou]|ough)/, br: 'Ã°', am: 'Ã°', type: 'consonant', desc: 'thåœ¨ä»£è¯/ä»‹è¯ä¸­å‘/Ã°/' },
            { pattern: /^th/, br: 'Î¸', am: 'Î¸', type: 'consonant', desc: 'thå‘/Î¸/' },
            
            // wh ç»„åˆ
            { pattern: /^wh/, br: 'w', am: 'w', type: 'consonant', desc: 'whå‘/w/' },
            
            // wr ç»„åˆ
            { pattern: /^wr/, br: 'r', am: 'r', type: 'consonant', desc: 'wrå‘/r/' },
            
            // kn ç»„åˆ
            { pattern: /^kn/, br: 'n', am: 'n', type: 'consonant', desc: 'knå‘/n/' },
            
            // ph ç»„åˆ
            { pattern: /^ph/, br: 'f', am: 'f', type: 'consonant', desc: 'phå‘/f/' },
            
            // gh ç»„åˆ
            { pattern: /gh$/, br: '', am: '', type: 'silent', desc: 'ghåœ¨è¯å°¾ä¸å‘éŸ³' },
            { pattern: /igh/, br: 'aÉª', am: 'aÉª', type: 'vowel', desc: 'ighå‘/aÉª/' },
            { pattern: /eigh/, br: 'eÉª', am: 'e', type: 'vowel', desc: 'eighå‘/eÉª/' },
            
            // qu ç»„åˆ
            { pattern: /^qu/, br: 'kw', am: 'kw', type: 'consonant', desc: 'quå‘/kw/' },
            
            // ng/nk ç»„åˆ
            { pattern: /nge/, br: 'ndÊ’', am: 'ndÊ’', type: 'consonant', desc: 'ngeå‘/ndÊ’/' },
            { pattern: /ng$/, br: 'Å‹', am: 'Å‹', type: 'consonant', desc: 'ngåœ¨è¯å°¾å‘/Å‹/' },
            { pattern: /nk/, br: 'Å‹k', am: 'Å‹k', type: 'consonant', desc: 'nkå‘/Å‹k/' },
            
            // ch/tch ç»„åˆ
            { pattern: /tch/, br: 'tÊƒ', am: 'tÊƒ', type: 'consonant', desc: 'tchå‘/tÊƒ/' },
            { pattern: /^ch/, br: 'tÊƒ', am: 'tÊƒ', type: 'consonant', desc: 'chå‘/tÊƒ/' },
            { pattern: /ch$/, br: 'tÊƒ', am: 'tÊƒ', type: 'consonant', desc: 'chåœ¨è¯å°¾å‘/tÊƒ/' },
            
            // sh ç»„åˆ
            { pattern: /sh/, br: 'Êƒ', am: 'Êƒ', type: 'consonant', desc: 'shå‘/Êƒ/' },
            
            // tion/sion ç»„åˆ
            { pattern: /tion/, br: 'Êƒn', am: 'Êƒn', type: 'consonant', desc: 'tionå‘/Êƒn/' },
            { pattern: /sion/, br: 'Ê’n', am: 'Ê’n', type: 'consonant', desc: 'sionå‘/Ê’n/' },
            
            // sure ç»„åˆ
            { pattern: /sure/, br: 'ÊƒÉ™', am: 'ÊƒÉ™r', type: 'consonant', desc: 'sureå‘/ÊƒÉ™/' },
            
            // ===== å…ƒéŸ³ç»„åˆ =====
            // ee/ea
            { pattern: /^ee/, br: 'iË', am: 'i', type: 'vowel', desc: 'eeå‘/iË/' },
            { pattern: /^ea(?=r)/, br: 'ÉªÉ™', am: 'Éªr', type: 'vowel', desc: 'earå‘/ÉªÉ™/' },
            { pattern: /^ea/, br: 'iË', am: 'i', type: 'vowel', desc: 'eaå‘/iË/' },
            
            // oo
            { pattern: /^oo(?=r)/, br: 'É”Ë', am: 'É”r', type: 'vowel', desc: 'oorå‘/É”Ë/' },
            { pattern: /^oo/, br: 'uË', am: 'u', type: 'vowel', desc: 'ooå‘/uË/' },
            
            // ou/ow
            { pattern: /^ou/, br: 'aÊŠ', am: 'aÊŠ', type: 'vowel', desc: 'ouå‘/aÊŠ/' },
            { pattern: /^ow$/, br: 'É™ÊŠ', am: 'o', type: 'vowel', desc: 'owåœ¨è¯å°¾å‘/É™ÊŠ/' },
            { pattern: /^ow/, br: 'aÊŠ', am: 'aÊŠ', type: 'vowel', desc: 'owå‘/aÊŠ/' },
            
            // oi/oy
            { pattern: /^oi/, br: 'É”Éª', am: 'É”Éª', type: 'vowel', desc: 'oiå‘/É”Éª/' },
            { pattern: /^oy/, br: 'É”Éª', am: 'É”Éª', type: 'vowel', desc: 'oyå‘/É”Éª/' },
            
            // ai/ay
            { pattern: /^ai/, br: 'eÉª', am: 'e', type: 'vowel', desc: 'aiå‘/eÉª/' },
            { pattern: /^ay/, br: 'eÉª', am: 'e', type: 'vowel', desc: 'ayå‘/eÉª/' },
            
            // au/aw
            { pattern: /^au/, br: 'É”Ë', am: 'É”Ë', type: 'vowel', desc: 'auå‘/É”Ë/' },
            { pattern: /^aw/, br: 'É”Ë', am: 'É”Ë', type: 'vowel', desc: 'awå‘/É”Ë/' },
            
            // ar
            { pattern: /^are$/, br: 'eÉ™', am: 'er', type: 'vowel', desc: 'areå‘/eÉ™/' },
            { pattern: /^ar/, br: 'É‘Ë', am: 'É‘Ër', type: 'vowel', desc: 'arå‘/É‘Ë/' },
            
            // er/ir/ur
            { pattern: /^er/, br: 'ÉœË', am: 'É', type: 'vowel', desc: 'erå‘/ÉœË/' },
            { pattern: /^ir/, br: 'ÉœË', am: 'É', type: 'vowel', desc: 'irå‘/ÉœË/' },
            { pattern: /^ur/, br: 'ÉœË', am: 'É', type: 'vowel', desc: 'urå‘/ÉœË/' },
            
            // or/ore
            { pattern: /^ore/, br: 'É”Ë', am: 'É”Ër', type: 'vowel', desc: 'oreå‘/É”Ë/' },
            { pattern: /^or/, br: 'É”Ë', am: 'É”Ër', type: 'vowel', desc: 'orå‘/É”Ë/' },
            
            // oa
            { pattern: /^oa/, br: 'É™ÊŠ', am: 'o', type: 'vowel', desc: 'oaå‘/É™ÊŠ/' },
            
            // ue/ui
            { pattern: /^ue/, br: 'uË', am: 'u', type: 'vowel', desc: 'ueå‘/uË/' },
            { pattern: /^ui/, br: 'uË', am: 'u', type: 'vowel', desc: 'uiå‘/uË/' },
            
            // ===== å•ä¸ªå…ƒéŸ³å­—æ¯ =====
            // a
            { pattern: /^a$/, br: 'É™', am: 'É™', type: 'vowel', desc: 'aåœ¨è¯å°¾éé‡è¯»å‘/É™/' },
            { pattern: /^a(?=e)/, br: 'eÉª', am: 'e', type: 'vowel', desc: 'a_eå‘/eÉª/' },
            { pattern: /^a/, br: 'Ã¦', am: 'Ã¦', type: 'vowel', desc: 'aå‘/Ã¦/' },
            
            // e
            { pattern: /^e$/, br: '', am: '', type: 'silent', desc: 'eåœ¨è¯å°¾ä¸å‘éŸ³' },
            { pattern: /^e(?=[iy])/, br: 'iË', am: 'i', type: 'vowel', desc: 'eåœ¨i,yå‰å‘/iË/' },
            { pattern: /^e/, br: 'e', am: 'É›', type: 'vowel', desc: 'eå‘/e/' },
            
            // i
            { pattern: /^i$/, br: 'aÉª', am: 'aÉª', type: 'vowel', desc: 'iåœ¨è¯å°¾å‘/aÉª/' },
            { pattern: /^i(?=e|gh)/, br: 'aÉª', am: 'aÉª', type: 'vowel', desc: 'i_e/ighå‘/aÉª/' },
            { pattern: /^i(?=nd|ld|gh)/, br: 'aÉª', am: 'aÉª', type: 'vowel', desc: 'ind/ild/ighå‘/aÉª/' },
            { pattern: /^i/, br: 'Éª', am: 'Éª', type: 'vowel', desc: 'iå‘/Éª/' },
            
            // o
            { pattern: /^o$/, br: 'É™ÊŠ', am: 'o', type: 'vowel', desc: 'oåœ¨è¯å°¾å‘/É™ÊŠ/' },
            { pattern: /^o(?=ld|lt|ll|lk)/, br: 'É™ÊŠ', am: 'o', type: 'vowel', desc: 'oldç­‰å‘/É™ÊŠ/' },
            { pattern: /^o/, br: 'É’', am: 'É‘', type: 'vowel', desc: 'oå‘/É’/' },
            
            // u
            { pattern: /^u(?=r)/, br: 'ÉœË', am: 'É', type: 'vowel', desc: 'urå‘/ÉœË/' },
            { pattern: /^u/, br: 'ÊŒ', am: 'ÊŒ', type: 'vowel', desc: 'uå‘/ÊŒ/' },
            
            // y
            { pattern: /^y$/, br: 'i', am: 'i', type: 'vowel', desc: 'yåœ¨è¯å°¾å‘/i/' },
            { pattern: /^y(?=[aeiou])/, br: 'j', am: 'j', type: 'consonant', desc: 'yåœ¨å…ƒéŸ³å‰å‘/j/' },
            { pattern: /^y/, br: 'Éª', am: 'Éª', type: 'vowel', desc: 'yå‘/Éª/' },
            
            // ===== å•ä¸ªè¾…éŸ³å­—æ¯ =====
            { pattern: /^b/, br: 'b', am: 'b', type: 'consonant', desc: 'bå‘/b/' },
            { pattern: /^c(?=[iey])/, br: 's', am: 's', type: 'consonant', desc: 'cåœ¨i,e,yå‰å‘/s/' },
            { pattern: /^c/, br: 'k', am: 'k', type: 'consonant', desc: 'cå‘/k/' },
            { pattern: /^d/, br: 'd', am: 'd', type: 'consonant', desc: 'då‘/d/' },
            { pattern: /^f/, br: 'f', am: 'f', type: 'consonant', desc: 'få‘/f/' },
            { pattern: /^g(?=[iey])/, br: 'dÊ’', am: 'dÊ’', type: 'consonant', desc: 'gåœ¨i,e,yå‰å‘/dÊ’/' },
            { pattern: /^g/, br: 'g', am: 'g', type: 'consonant', desc: 'gå‘/g/' },
            { pattern: /^h/, br: 'h', am: 'h', type: 'consonant', desc: 'hå‘/h/' },
            { pattern: /^j/, br: 'dÊ’', am: 'dÊ’', type: 'consonant', desc: 'jå‘/dÊ’/' },
            { pattern: /^k/, br: 'k', am: 'k', type: 'consonant', desc: 'kå‘/k/' },
            { pattern: /^l/, br: 'l', am: 'l', type: 'consonant', desc: 'lå‘/l/' },
            { pattern: /^m/, br: 'm', am: 'm', type: 'consonant', desc: 'må‘/m/' },
            { pattern: /^n/, br: 'n', am: 'n', type: 'consonant', desc: 'nå‘/n/' },
            { pattern: /^p/, br: 'p', am: 'p', type: 'consonant', desc: 'på‘/p/' },
            { pattern: /^r/, br: 'r', am: 'É¹', type: 'consonant', desc: 'rå‘/r/' },
            { pattern: /^s$/, br: 's', am: 's', type: 'consonant', desc: 'såœ¨è¯å°¾å‘/s/' },
            { pattern: /^s/, br: 's', am: 's', type: 'consonant', desc: 'så‘/s/' },
            { pattern: /^t/, br: 't', am: 't', type: 'consonant', desc: 'tå‘/t/' },
            { pattern: /^v/, br: 'v', am: 'v', type: 'consonant', desc: 'vå‘/v/' },
            { pattern: /^w/, br: 'w', am: 'w', type: 'consonant', desc: 'wå‘/w/' },
            { pattern: /^x/, br: 'ks', am: 'ks', type: 'consonant', desc: 'xå‘/ks/' },
            { pattern: /^z/, br: 'z', am: 'z', type: 'consonant', desc: 'zå‘/z/' }
        ];

        // éŸ³èŠ‚åˆ’åˆ†å‡½æ•°
        function splitIntoSyllables(word) {
            word = word.toLowerCase();
            const vowels = 'aeiouy';
            const syllables = [];
            let current = '';
            let vowelCount = 0;
            
            for (let i = 0; i < word.length; i++) {
                const char = word[i];
                const isVowel = vowels.includes(char);
                
                if (isVowel) {
                    vowelCount++;
                }
                
                current += char;
                
                // æ£€æŸ¥æ˜¯å¦éœ€è¦åˆ†å‰²éŸ³èŠ‚
                if (vowelCount > 0 && i < word.length - 1) {
                    const nextChar = word[i + 1];
                    const nextIsVowel = vowels.includes(nextChar);
                    
                    // å½“å‰æ˜¯å…ƒéŸ³ï¼Œä¸‹ä¸€ä¸ªæ˜¯è¾…éŸ³
                    if (isVowel && !nextIsVowel) {
                        // æ£€æŸ¥åé¢æ˜¯å¦æœ‰å…ƒéŸ³
                        let hasNextVowel = false;
                        for (let j = i + 2; j < word.length; j++) {
                            if (vowels.includes(word[j])) {
                                hasNextVowel = true;
                                break;
                            }
                        }
                        
                        if (hasNextVowel) {
                            // æ£€æŸ¥è¾…éŸ³ç»„åˆ
                            if (i + 2 < word.length) {
                                const cc = nextChar + word[i + 2];
                                // è¿™äº›è¾…éŸ³ç»„åˆä¸åˆ†å‰²
                                const blendConsonants = ['bl', 'br', 'cl', 'cr', 'dr', 'fl', 'fr', 'gl', 'gr', 'pl', 'pr', 'sc', 'sk', 'sl', 'sm', 'sn', 'sp', 'st', 'sw', 'tr', 'tw', 'dr', 'qu', 'th', 'sh', 'ch', 'ph', 'gh', 'ng', 'nk'];
                                
                                if (!blendConsonants.includes(cc) && !vowels.includes(word[i + 2])) {
                                    // ä¸¤ä¸ªè¾…éŸ³ï¼Œåˆ†å‰²åœ¨å®ƒä»¬ä¹‹é—´
                                    syllables.push(current);
                                    current = '';
                                    vowelCount = 0;
                                }
                            }
                        }
                    }
                }
            }
            
            if (current) {
                syllables.push(current);
            }
            
            return syllables.length > 0 ? syllables : [word];
        }

        // ç¡®å®šé‡éŸ³ä½ç½®
        function findStressPosition(syllables) {
            const count = syllables.length;
            
            if (count === 1) return 0;
            if (count === 2) return 0; // åŒéŸ³èŠ‚è¯é€šå¸¸ç¬¬ä¸€éŸ³èŠ‚é‡è¯»
            
            // æ£€æŸ¥åç¼€
            const last = syllables[count - 1].toLowerCase();
            const secondLast = syllables[count - 2].toLowerCase();
            
            // è¿™äº›åç¼€é‡è¯»åœ¨å€’æ•°ç¬¬äºŒéŸ³èŠ‚
            const penultimateStress = ['tion', 'sion', 'ic', 'ity', 'ify', 'ize', 'ise', 'ee', 'eer', 'ese', 'ique'];
            for (const suffix of penultimateStress) {
                if (last.includes(suffix) || secondLast.includes(suffix)) {
                    return count - 2;
                }
            }
            
            // é»˜è®¤å€’æ•°ç¬¬ä¸‰éŸ³èŠ‚é‡è¯»
            return Math.max(0, count - 3);
        }

        // åº”ç”¨å‘éŸ³è§„åˆ™åˆ°éŸ³èŠ‚
        function applyRules(syllable, isStressed) {
            let remaining = syllable.toLowerCase();
            let brResult = '';
            let amResult = '';
            const appliedRules = [];
            
            while (remaining.length > 0) {
                let matched = false;
                
                for (const rule of PRONUNCIATION_RULES) {
                    const match = remaining.match(rule.pattern);
                    if (match) {
                        const matchedText = match[0];
                        
                        // åº”ç”¨é‡éŸ³è§„åˆ™ï¼šéé‡è¯»éŸ³èŠ‚çš„å…ƒéŸ³å¼±åŒ–ä¸º/É™/
                        if (!isStressed && rule.type === 'vowel') {
                            // æ£€æŸ¥æ˜¯å¦æ˜¯å¼±è¯»ä½ç½®
                            if (brResult.length > 0 || remaining.length > matchedText.length) {
                                // éé¦–éŸ³èŠ‚æˆ–è¯å°¾ï¼Œå…ƒéŸ³å¼±è¯»
                                if (['Ã¦', 'e', 'Éª', 'É’', 'ÊŒ'].includes(rule.br)) {
                                    brResult += 'É™';
                                    amResult += 'É™';
                                    appliedRules.push('éé‡è¯»éŸ³èŠ‚å¼±åŒ–ä¸º/É™/');
                                } else {
                                    brResult += rule.br;
                                    amResult += rule.am;
                                    appliedRules.push(rule.desc);
                                }
                            } else {
                                brResult += rule.br;
                                amResult += rule.am;
                                appliedRules.push(rule.desc);
                            }
                        } else {
                            brResult += rule.br;
                            amResult += rule.am;
                            appliedRules.push(rule.desc);
                        }
                        
                        remaining = remaining.slice(matchedText.length);
                        matched = true;
                        break;
                    }
                }
                
                if (!matched) {
                    // æ²¡æœ‰åŒ¹é…åˆ°è§„åˆ™ï¼Œè·³è¿‡è¿™ä¸ªå­—ç¬¦
                    remaining = remaining.slice(1);
                }
            }
            
            return { br: brResult, am: amResult, rules: appliedRules };
        }

        // ç”ŸæˆéŸ³æ ‡ä¸»å‡½æ•°
        function generatePhoneticTranscription(word) {
            word = word.toLowerCase().trim();
            
            if (!word || !/^[a-z]+$/.test(word)) {
                return null;
            }
            
            // éŸ³èŠ‚åˆ’åˆ†
            const syllables = splitIntoSyllables(word);
            const stressIndex = findStressPosition(syllables);
            
            let brTranscription = '';
            let amTranscription = '';
            const allRules = [];
            
            for (let i = 0; i < syllables.length; i++) {
                const isStressed = (i === stressIndex);
                const result = applyRules(syllables[i], isStressed);
                
                // æ·»åŠ é‡éŸ³ç¬¦å·
                if (isStressed) {
                    brTranscription += 'Ëˆ';
                    amTranscription += 'Ëˆ';
                } else if (i === 0 && stressIndex > 1) {
                    // é¦–éŸ³èŠ‚æœ‰æ¬¡é‡éŸ³
                    brTranscription += 'ËŒ';
                    amTranscription += 'ËŒ';
                }
                
                brTranscription += result.br;
                amTranscription += result.am;
                allRules.push(...result.rules);
                
                // éŸ³èŠ‚ä¹‹é—´æ·»åŠ åˆ†éš”ç¬¦
                if (i < syllables.length - 1) {
                    brTranscription += '.';
                    amTranscription += '.';
                }
            }
            
            return {
                br: '/' + brTranscription + '/',
                am: '/' + amTranscription + '/',
                syllables: syllables,
                rules: [...new Set(allRules)]
            };
        }

        // UI å‡½æ•°
        function generatePhonetic() {
            const wordInput = document.getElementById('wordInput');
            const word = wordInput.value.trim().toLowerCase();
            const errorMessage = document.getElementById('errorMessage');
            const resultSection = document.getElementById('resultSection');

            if (!word) {
                resultSection.classList.remove('show');
                errorMessage.classList.remove('show');
                return;
            }

            if (!/^[a-z]+$/.test(word)) {
                resultSection.classList.remove('show');
                return;
            }

            errorMessage.classList.remove('show');

            const result = generatePhoneticTranscription(word);

            if (!result) {
                resultSection.classList.remove('show');
                return;
            }

            document.getElementById('britishPhonetic').textContent = result.br;
            document.getElementById('americanPhonetic').textContent = result.am;

            // æ˜¾ç¤ºéŸ³èŠ‚ä¿¡æ¯
            const syllableInfo = document.getElementById('syllableInfo');
            syllableInfo.innerHTML = `
                <strong>éŸ³èŠ‚åˆ’åˆ†:</strong> ${result.syllables.join(' - ')}<br>
                <strong>éŸ³èŠ‚æ•°:</strong> ${result.syllables.length} ä¸ªéŸ³èŠ‚
            `;

            // æ˜¾ç¤ºåº”ç”¨çš„è§„åˆ™
            const rulesInfo = document.getElementById('rulesInfo');
            if (result.rules && result.rules.length > 0) {
                rulesInfo.innerHTML = result.rules.map((rule, index) => 
                    `${index + 1}. ${rule}`
                ).join('<br>');
            } else {
                rulesInfo.innerHTML = 'ä½¿ç”¨æ ‡å‡†å‘éŸ³è§„åˆ™';
            }

            resultSection.classList.add('show');
        }

        function setWord(word) {
            document.getElementById('wordInput').value = word;
            generatePhonetic();
        }

        // è¾“å…¥æ—¶è‡ªåŠ¨è§¦å‘
        const wordInput = document.getElementById('wordInput');
        wordInput.addEventListener('input', function(e) {
            generatePhonetic();
        });

        // é¡µé¢åŠ è½½æ—¶èšç„¦è¾“å…¥æ¡†
        window.addEventListener('load', function() {
            wordInput.focus();
        });
    </script>
</body>
</html>
